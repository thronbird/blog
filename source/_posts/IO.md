---
title: IO
---

当用户线程发起I/O操作后，网络数据读取操作会经历两个步骤：

- 用户线程等待内核将数据从网卡拷贝到内核空间。

- 内核将数据从内核空间拷贝到用户空间。

各种I/O模型的区别就是：它们实现这两个步骤的方式是不一样的.

**同步阻塞I/O**：用户线程发起read调用后就阻塞了，让出CPU。内核等待网卡数据到来，把数据从网卡拷贝 到内核空间，接着把数据拷贝到用户空间，再把用户线程叫醒。

**同步非阻塞I/O**：用户线程不断的发起read调用，数据没到内核空间时，每次都返回失败，直到数据到了内 核空间，这一次read调用后，在等待数据从内核空间拷贝到用户空间这段时间里，线程还是阻塞的，等数据 到了用户空间再把线程叫醒。

**I/O多路复用**：用户线程的读取操作分成两步了，线程先发起select调用，目的是问内核数据准备好了吗？等 内核把数据准备好了，用户线程再发起read调用。在等待数据从内核空间拷贝到用户空间这段时间里，线程 还是阻塞的。那为什么叫I/O多路复用呢？因为一次select调用可以向内核查多个数据通道（Channel）的状 态，所以叫多路复用。

**异步I/O**：用户线程发起read调用的同时注册一个回调函数，read立即返回，等内核将数据准备好后，再调 用指定的回调函数完成处理。在这个过程中，用户线程一直没有阻塞。

IO多路复用和异步IO区别：是内核主动将数据拷贝到用户空间并通知应用程序。还是等待应用程序通过Selector来查询，当数据就绪 后，应用程序再发起一个read调用，这时内核再把数据从内核空间拷贝到用户空间。异步IO中，应用程序在调用read API的同时告诉内核两件事情：数据准备好了以后拷贝到哪个Buffer，以及调用 哪个回调函数去处理这些数据。

-《Tomcat》